events{
}

http {
    server {
      listen 80;
      server_name http://jibbyjabber.hopto.org;

      location / {
          return 301 https://$host$request_uri;
      }
    }
    
    server {
       listen 443 ssl;
       server_name http://jibbyjabber.hopto.org;
    
      location / {
        proxy_pass         http://jibby-jabber-client:80/;
        proxy_set_header   Host $host;
      }
        
      location /api/ {
              proxy_pass         http://jibby-jabber:8080/;
              proxy_set_header   Host $host;
      }
        
      location /messages/ {
            proxy_pass         http://jibby-jabber-messages:8084/;
            proxy_set_header   Host $host;
      }
    }
}
